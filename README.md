# 图片关键词识别插件 astrbot_plugin_33recognition

## v1.0.0

这是一个用于 **astrbot** 的插件，它能够调用大型语言模型（LLM）来检测用户发送的图片中是否包含预设的**关键词**（及其发音相似的中文词语）。一旦检测到关键词，插件将发送自定义的回复文本和图片。

## ✨ 主要功能

- **图片内容检测：** 调用 LLM 对用户发送的图片进行分析，判断图片内容是否包含预设的关键词。
- **相似发音识别：** 通过 LLM 的 `system_prompt`，支持对关键词的**发音相似**的中文词语（例如，关键词为“33”时，识别“珊珊”或“山山”）进行模糊匹配。
- **自定义回复：**
  - 支持自定义回复的**文本**内容。
  - 支持配置回复**图片**列表。
  - 可选择是否 `@` 消息发送者。
- **会话控制：** 支持**白名单**和**黑名单**配置，精确控制插件在哪些群组或私聊中生效。

## 指令说明

本插件主要依赖消息事件自动触发，**不提供**直接的指令交互。

| 触发方式                 | 功能说明                                                           | 权限     |
| :----------------------- | :----------------------------------------------------------------- | :------- |
| **发送带图片的聊天消息** | 插件自动调用大模型检测图片内容，若检测到关键词，则发送自定义回复。 | 所有用户 |

## 配置项

您可以在 AstrBot 的配置文件中配置以下项来自定义插件行为：

| 配置项                  | 描述                                            | 类型     | 默认值         | 备注                                                                                          |
| :---------------------- | :---------------------------------------------- | :------- | :------------- | :-------------------------------------------------------------------------------------------- |
| `important_word`        | 要在图片中检测的**关键词**。                    | `string` | `"33"`         | LLM 会尝试识别此关键词及其相似发音的中文词语。                                                |
| `reply_text`            | 检测到关键词后，要发送的**回复文本**。          | `string` | `"nybb"`       | 自定义回复内容。                                                                              |
| `at_on`                 | 回复时是否 `@` 消息发送者。                     | `bool`   | `true`         | `true` 为启用，`false` 为禁用。                                                               |
| `reply_image_name_list` | 回复图片的文件名列表（含后缀）。                | `list`   | `["nybb.jpg"]` | 图片文件需放置在`AstrBot\data\plugin_data\astrbot_plugin_33recognition`下。留空则不回复图片。 |
| `white_list_on`         | 是否**启用白名单**（仅在列表中的群/私聊生效）。 | `bool`   | `false`        |                                                                                               |
| `white_list`            | 白名单的 QQ 群号或 QQ 号列表。                  | `list`   | `[]`           |                                                                                               |
| `black_list_on`         | 是否**启用黑名单**（在列表中的群/私聊不生效）。 | `bool`   | `false`        |                                                                                               |
| `black_list`            | 黑名单的 QQ 群号或 QQ 号列表。                  | `list`   | `[]`           |                                                                                               |

## 注意事项

- **LLM Provider：** 本插件的图片识别功能依赖于当前会话配置的 llm，所以确保该大模型可以识别图片内容。并且该插件可能会消耗一些 api 额度，请根据自身需要决定是否使用。
- **图片路径：** 配置的回复图片（如 `nybb.jpg`）必须放置在插件的**AstrBot\data\plugin_data\astrbot_plugin_33recognition**下。
- **若有问题欢迎提交 issue**

## ⭐ Stars

> [!TIP]
> 如果本项目对您的生活 / 工作产生了帮助，或者您关注本项目的未来发展，请给项目 Star，这是我维护这个开源项目的动力 ❤️。
